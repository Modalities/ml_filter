model:
  name: Snowflake/snowflake-arctic-embed-m
  freeze_base_model_parameters: true  # Add option to freeze encoder
  num_tasks: ${data.num_tasks}  # Number of prediction tasks
  num_targets_per_task: ${data.num_targets_per_task}  # Number of classes per output

tokenizer:
  pretrained_model_name_or_path: ${model.name}
  truncation: true
  padding: true
  max_length: 512
  add_generation_prompt: true

data: 
  train_file_path: /raid/s3/fm_tmp/data/annotated_fineweb_train.jsonl
  train_file_split: train
  test_file_path:
  test_file_split: train
  val_file_path: /raid/s3/fm_tmp/data/annotated_fineweb_val.jsonl
  val_file_split: train
  label_column: scores  # Ensure this matches dataset format
  text_column: text  # Ensure this matches dataset format
  document_id_column: id  # Ensure this matches dataset format
  num_tasks: 1
  num_targets_per_task: [6]
  task_names: ["edu"]
  num_processes: 64

training:
  batch_size: 256
  eval_batch_size: 256
  epochs: 20
  use_bf16: true
  weight_decay: 0.01
  eval_strategy: epoch
  save_strategy: epoch
  logging_steps: 100
  seed: 42
  greater_is_better: true  # Spearman correlation is maximised
  metric_for_best_model: eval_validation_edu/spearman_corr
  learning_rate: 0.0003
  logging_dir_path: data/output/fineweb_edu_model_artic_v1_m
  output_dir_path: ${training.logging_dir_path}
  dataloader_num_workers: 16
  load_best_model_at_end: true
